---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';

const posts = await getCollection('blog', ({ data }) => !data.draft);
const sortedPosts = posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="maguro.dev" description="技術ブログ">
  <section class="posts">
    <h1 class="sr-only">Posts</h1>
    {sortedPosts.length === 0 ? (
      <p class="no-posts">No posts yet.</p>
    ) : (
      <ul class="post-list">
        {sortedPosts.map((post) => (
          <li>
            <PostCard post={post} />
          </li>
        ))}
      </ul>
    )}
  </section>
</BaseLayout>

<style>
  .posts {
    padding-top: var(--spacing-unit);
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: calc(var(--spacing-unit) * 2);
  }

  .no-posts {
    color: var(--color-text-secondary);
    text-align: center;
    padding: calc(var(--spacing-unit) * 4);
  }
</style>
